(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{140:function(e,t,a){},167:function(e,t){},170:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"registerUser",function(){return y}),a.d(n,"loginUser",function(){return U}),a.d(n,"setCurrentUser",function(){return w}),a.d(n,"logoutUser",function(){return R});var r={};a.r(r),a.d(r,"createShortUrl",function(){return Q});var l=a(0),o=a.n(l),i=a(42),s=a.n(i),c=(a(74),a(9)),u=a(10),h=a(13),m=a(11),p=a(14),d=a(174),f=a(175),E=a(171),g=a(32),b=a.n(g),v=a(25),S=a.n(v),O=function(e){e?S.a.defaults.headers.common.Authorization=e:delete S.a.defaults.headers.common.Authorization},C=S.a.create({baseURL:""}),j="https://wicakerbitlyclone.herokuapp.com/",y=function(e){return function(t){C.post("/api/users/register",e).then(function(e){return console.log(e)}).then(function(e){t({type:"REGISTER_SUCCESS"})}).catch(function(e){t({type:"REGISTER_ERROR",err:e})})}},U=function(e){return function(t){C.post("/api/users/login",e).then(function(e){var a=e.data.token;localStorage.setItem("jwtToken",a),O(a);var n=b()(a);t(w(n))}).catch(function(e){t({type:"LOGIN_ERROR",err:e})})}},w=function(e){return{type:"LOGIN_SUCCESS",payload:e}},R=function(){return function(e){localStorage.removeItem("jwtToken"),O(!1),e(w({}))}},k=a(17),N=a(16),I=function(e){return void 0===e||null===e||"object"===typeof e&&0===Object.keys(e).length||"string"===typeof e&&0===e.trim().length},_={authError:null,isAuthenticated:!1,user:{},registerStatus:!1},D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN_ERROR":return console.log("login error"),Object(N.a)({},e,{authError:"Login failed"});case"LOGIN_SUCCESS":return console.log("login success"),Object(N.a)({},e,{authError:null,isAuthenticated:!I(t.payload),user:t.payload});case"REGISTER_SUCCESS":return console.log("register success"),Object(N.a)({},e,{authError:null,registerStatus:!0});case"REGISTER_ERROR":return Object(N.a)({},e,{authError:t.err.response.data});default:return e}},L={urlShort:""},A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHORT_URL_SUCCESS":return console.log("success"),Object(N.a)({},e,{urlShort:t.res.data.shortUrl});case"SHORT_URL_ERROR":return console.log("short url error"),e;default:return e}},T=Object(k.c)({auth:D,shortUrl:A}),B=a(67),G=Object(k.e)(T,Object(k.d)(Object(k.a)(B.a))),x=a(2),M=a(139),H=a(7),P=a(172),Y=Object(H.b)(function(e){return e},n)(function(e){var t=e.logoutUser;return o.a.createElement("div",null,o.a.createElement("ul",{className:"right"},o.a.createElement("li",null,o.a.createElement(P.a,{to:"/myurl"},"My Url")),o.a.createElement("li",null,o.a.createElement(P.a,{to:"/logout",onClick:t},"Log Out"))))}),z=function(){return o.a.createElement("div",null,o.a.createElement("ul",{className:"right"},o.a.createElement("li",null,o.a.createElement(P.a,{to:"/register"},"Register")),o.a.createElement("li",null,o.a.createElement(P.a,{to:"/login"},"Login"))))},W=Object(H.b)(function(e){return e},n)(function(e){var t=!0===e.auth.isAuthenticated?o.a.createElement(Y,{props:e}):o.a.createElement(z,null);return o.a.createElement(x.Navbar,{className:"green"},o.a.createElement("div",{className:"container"},o.a.createElement(M.a,{to:"/",className:"brand-logo"},"URL Shorter"),t))}),F=a(12),J=a(173),V=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(h.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={name:"",email:"",password:"",password2:""},a.handleChange=function(e){a.setState(Object(F.a)({},e.target.id,e.target.value))},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"handleSubmit",value:function(e){e.preventDefault(),this.props.registerUser(this.state)}},{key:"render",value:function(){if(this.props.auth.registerStatus)return o.a.createElement(J.a,{to:"/login"});var e="",t="",a="",n="";return null!=this.props.auth.authError&&(e=this.props.auth.authError.name||"",t=this.props.auth.authError.email||"",n=this.props.auth.authError.password||"",a=this.props.auth.authError.password2||""),o.a.createElement("form",{onSubmit:this.handleSubmit.bind(this),className:"center container"},o.a.createElement(x.Row,null,o.a.createElement(x.Input,{s:12,label:"Name",id:"name",error:e,onChange:this.handleChange}),o.a.createElement(x.Input,{s:12,type:"email",label:"Email",id:"email",error:t,onChange:this.handleChange}),o.a.createElement(x.Input,{s:12,type:"password",label:"Password",id:"password",error:n,onChange:this.handleChange}),o.a.createElement(x.Input,{s:12,type:"password",label:"Confirm Password",id:"password2",error:a,onChange:this.handleChange})),o.a.createElement(x.Button,{type:"submit",value:"Submit"},"Register"))}}]),t}(l.Component),$=Object(H.b)(function(e){return e},n)(V),q=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(h.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={email:"",password:""},a.handleChange=function(e){a.setState(Object(F.a)({},e.target.id,e.target.value))},a.handleSubmit=function(e){e.preventDefault(),a.props.loginUser(a.state)},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return this.props.auth.isAuthenticated?o.a.createElement(J.a,{to:"/"}):o.a.createElement("form",{onSubmit:this.handleSubmit.bind(this),className:"center container"},o.a.createElement(x.Row,null,o.a.createElement(x.Input,{name:"email",s:12,type:"email",label:"Email",id:"email",onChange:this.handleChange}),o.a.createElement(x.Input,{name:"password",s:12,type:"password",label:"Password",id:"password",onChange:this.handleChange})),o.a.createElement(x.Button,{type:"submit",value:"Submit"},"Login"))}}]),t}(l.Component),K=Object(H.b)(function(e){return e},n)(q),Q=(a(140),function(e){return function(t){C.post("/api/shorters",e).then(function(e){console.log(e),t({type:"SHORT_URL_SUCCESS",res:e})}).catch(function(e){t({type:"SHORT_URL_ERROR",err:e})})}}),X=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(h.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={originalUrl:""},a.handleChange=function(e){a.setState(Object(F.a)({},e.target.id,e.target.value))},a.handleSubmit=function(e){e.preventDefault(),a.props.createShortUrl(a.state)},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.shortUrl.urlShort||"";return o.a.createElement("div",{className:"App App-header"},o.a.createElement(x.Modal,{header:"Shorting URL",trigger:o.a.createElement(x.Button,null,"Create")},o.a.createElement("form",{onSubmit:this.handleSubmit.bind(this),className:"center container"},o.a.createElement(x.Row,null,o.a.createElement(x.Input,{s:12,label:"Paste your url",id:"originalUrl",onChange:this.handleChange})),o.a.createElement("p",null,"Your short url :"," ",this.props.auth.isAuthenticated?o.a.createElement("a",{href:e},e):"Your login session outdated, You must login first"),o.a.createElement(x.Button,{type:"submit",value:"Submit"},"Create"))))}}]),t}(l.Component),Z=Object(H.b)(function(e){return e},r)(X),ee=Object(H.b)(function(e){return e},n)(function(e){return o.a.createElement("div",{className:"blue lighten-5 "},o.a.createElement(x.Row,{className:"container"},o.a.createElement("img",{src:e.auth.user.avatar,alt:"profile",className:"circle"}),o.a.createElement("h4",null,e.auth.user.name)))}),te=a(68),ae=a.n(te),ne=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(h.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={title:a.props.props.title,urlCode:a.props.props.urlCode,originalUrl:a.props.props.originalUrl,shortUrl:a.props.props.shortUrl,response:""},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"handleChange",value:function(e){this.setState(Object(F.a)({},e.target.id,e.target.value))}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),C.put("/api/shorters/update/"+this.props.props._id,Object(N.a)({},this.state,{shortUrl:j+this.state.urlCode})).then(function(e){t.setState({response:e.status})}).catch(function(e){console.log(e),t.setState({response:404})})}},{key:"render",value:function(){var e="";return 200===this.state.response&&(e=o.a.createElement("p",{className:"green-text"},"Success")),404===this.state.response&&(e=o.a.createElement("p",{className:"red-text"},"Failed, URL already axist")),o.a.createElement("form",{onSubmit:this.handleSubmit.bind(this),className:"center container"},o.a.createElement(x.Row,null,o.a.createElement(x.Input,{s:12,defaultValue:this.props.props.title,label:"title",id:"title",onChange:this.handleChange.bind(this)}),o.a.createElement(x.Input,{s:12,defaultValue:this.props.props.urlCode,label:j,id:"urlCode",onChange:this.handleChange.bind(this)})),o.a.createElement("div",null,e),o.a.createElement(x.Button,{type:"submit",value:"Submit"},"Edit"))}}]),t}(l.Component),re=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(h.a)(this,Object(m.a)(t).call(this,e))).formatDate=function(e){var t=new Date(e);return"".concat(t.getFullYear(),"-").concat(t.getMonth()+1,"-").concat(t.getDate())},a.state={listUrl:[],from:"2001-01-01",to:"9999-12-31"},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentWillMount",value:function(){var e=this;C.get("/api/shorters").then(function(t){e.setState({listUrl:t.data})}).catch(function(e){return console.log(e)});var t=ae()(j);t.on("shorter",function(t){var a=e.state.listUrl.map(function(e){return e.shortUrl===t.shortUrl&&(e.totalClicks=t.totalClicks),e});e.setState({listUrl:a})}),t.on("shorterUpdate",function(t){var a=e.state.listUrl.map(function(e){return e._id===t._id&&(e=t),e});e.setState({listUrl:a})})}},{key:"handleChange",value:function(e){this.setState(Object(F.a)({},e.target.id,this.formatDate(e.target.value)))}},{key:"handleSubmit",value:function(e){e.preventDefault()}},{key:"handlDelete",value:function(e){var t=this;C("/api/shorters/delete/"+e,{method:"DELETE"}).then(function(a){t.setState(function(t){return{listUrl:t.listUrl.filter(function(t){return t._id!==e})}})}).catch(function(e){console.log(e)})}},{key:"render",value:function(){var e=this,t=this.state,a=t.from,n=t.listUrl,r=t.to,l=n.filter(function(t){return e.formatDate(new Date(t.createdAt))>=a&&e.formatDate(new Date(t.createdAt))<=r}).map(function(t){return o.a.createElement(x.Row,{key:t._id,className:"z-depth-1"},o.a.createElement("div",{className:"container"},o.a.createElement(x.Col,{s:12},"Created At : ",t.createdAt),o.a.createElement(x.Col,{s:12},o.a.createElement("h4",null,t.title||"No Title")),o.a.createElement(x.Col,{s:12},"Original Url : ",o.a.createElement("a",{href:t.originalUrl},t.originalUrl)),o.a.createElement(x.Col,{s:12},"Short Url :"," ",o.a.createElement("a",{href:t.shortUrl,id:t.shortUrl},t.shortUrl)),o.a.createElement(x.Col,{s:12},"Total Clicks : ",o.a.createElement("h4",null,t.totalClicks)),o.a.createElement(x.Col,{s:12},o.a.createElement(x.Button,{s:2,className:"red ",onClick:e.handlDelete.bind(e,t._id)},"Delete"),o.a.createElement(x.Modal,{header:"Shorting URL",trigger:o.a.createElement(x.Button,null,"Edit")},o.a.createElement(ne,{props:t})))))});return o.a.createElement("div",{className:"center"},o.a.createElement(ee,null),o.a.createElement("form",{onSubmit:this.handleSubmit.bind(this),className:"container"},o.a.createElement(x.Row,null,o.a.createElement(x.Input,{s:6,type:"date",className:"datepicker",label:"from",id:"from",onChange:this.handleChange.bind(this)}),o.a.createElement(x.Input,{s:6,type:"date",className:"datepicker",label:"to",id:"to",onChange:this.handleChange.bind(this)}))),0!==l.length?l:"Data not found")}}]),t}(l.Component);if(localStorage.jwtToken){O(localStorage.jwtToken);var le=b()(localStorage.jwtToken);G.dispatch(w(le));var oe=Date.now()/1e3;le.exp<oe&&(G.dispatch(R()),window.location.href="/login")}var ie=function(e){function t(){return Object(c.a)(this,t),Object(h.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return o.a.createElement(d.a,null,o.a.createElement("div",null,o.a.createElement(W,null),o.a.createElement(f.a,null,o.a.createElement(E.a,{exact:!0,path:"/",component:Z}),o.a.createElement(E.a,{path:"/register",component:$}),o.a.createElement(E.a,{path:"/login",component:K}),o.a.createElement(E.a,{path:"/myurl",component:re}))))}}]),t}(l.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(o.a.createElement(H.a,{store:G},o.a.createElement(ie,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},69:function(e,t,a){e.exports=a(170)},74:function(e,t,a){}},[[69,2,1]]]);
//# sourceMappingURL=main.a8ce83a3.chunk.js.map